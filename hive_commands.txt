#To get hive command prompt
    $hive

#To see all databases
    >show databases;

#To create database my_database
    >create database my_database
    /* when we create a databse, it will have path /user/hive/warehouse/my_database.db/

#To create database if its not exists
    >create database if not exists my_database;

#To see databases whose names start with m 
    >show databases like 'm*';

#To save the databse in given directory
    > CREATE DATABASE dir1 LOCATION '/ana';

#To create database with comment
    >create database dir1 comment 'give your comment here';

#To delete databse with files in it
    >drop database if exists dir1 cascade; 

#To delete database without files
    >drop databse if exists dir2

#To use a database named my_database
    >use my_database

#To see tables inside selected database
    >show tables;
    /* if this step performed without selecting the database tables in default database will be displayed*/

#to copy table schema(not data)
    >CREATE TABLE IF NOT EXISTS dir1.employees2 LIKE dir2.employees;

#create table
    >create table if not exists table1(name string comment 'emp name',salary float comment 'emp salary',subordinates array<string> comment 'name of subordinates',desuctions map<string,float> comment 'keys are names and values are percentage' ,address struct<street:string,zip:int> comment 'address') comment 'table' location '/user/hive/warehouse/mydb.db/table1';

#To visualize all data in table1
    >select * from table1;

#To create a table called table1 with roll_no(integer) as a primary key,name varchar
    >create table table1 (roll_no int primary key,name string);

#To load data from a data.csv to table1
    >create table table1 (roll_no int primary key,name string) row format delimited fields terminated by '\t';
    >load data local inpath '/home/training/data.csv' into table table1;

#To describe a table
    > describe tabel

#external table
    >create external table if not exists frnds(id int,name string,age int,job string) row format delimited fields terminated by '\t' location '/anna';
    >load data local inpath '/home/training/myfile.csv' into table frnds;

#copy schema of external table
    > create external table new_table like frnds location '/vit';

#PARTITIONS
    >create table a5(id int,name string,age int)partitioned by (job_name string) row format delimited fields terminated by '\t';
    >load data local inpath '/home/training/zakku/engineer' into table a5 partition(job_name="engineer"); 
    >load data local inpath '/home/training/zakku/developer' into table a5 partition(job_name="developer"); 
    >load data local inpath '/home/training/zakku/dancer' into table a5 partition(job_name="dancer"); 
    /*creates 3 partition..
    >select * from a5 where job_name="dancer";
    /*because of partition select statement takes less time 

#to see partitions of a table named a5
    >show partitions a5;

#to delete a partition
    >alter table a5 drop if exists partition(job_name="dancer");

#to add a partition
    >alter table a5 add if not exists partition(job_name="dancer") location '/home/training/zakku/dancer';

#to get top n numbers(here 2)
    >select * from a5 limit 2;

#to delete a table
    >drop table if exists table1

#to rename a table
    >alter table old_name rename to new_table

#to change column name
    >alter table a3 change column name new_name string comment 'update' after id;
    /* oldname newname datatype ..after and comment is not necessary

#to add new column in table
    >alter table a3 add columns(new_col string comment 'new column');
    /*columnname type comment

#select statement
    >select id,name from t1;
                OR
    >SELECT e.name, e.salary FROM employees e;

#to capitalize string type column values
    >select upper(name) from t1;

#to make string lowercase
    >select lower(name) from t1;

#to round mathematical operation
    >select round(id/2) from t1;
















#To create a table in hive and add data to it from .csv file
    >create table table1(id int,name string) row format delimited fields terminated by ',';
    >load data local inpath '/home/training/file1.csv' into table table1;
    >select id,name from table1;

#counting characters
    $vi story.txt
    $hdfs dfs -mkdir /story
    $hdfs dfs -put story.txt /story/

    > create table input(text_lines string);
    >load data inpath '/story' into table input;
    >create table wordcount as select word,count(*) from input LATERAL VIEW explode(split(text_lines,' ')) 1table as word group by word;

            OR(THE LAST LINE FROM ABOVE SECTION CAN BE REPLACED BY)

    >select split(text_lines,' ') from input;    
    >create view input_split as select split(text_lines,' ') as word from input;
    >select explode(word) as w from input_split;   
    >create view input_explode as select explode(word) as w from input_split;
    >select w,count(*) from input_explode group by w;

#To see records within given limit   
    >select * from input limit 1;   /*gives first record..if limit2 give 2 records

    
 #movie
    $create database movie;
    $create table movie(mid int,mname string,year string) row format delimited fields terminated by '\t';
    $load data inpath '/movie_data/movie/' into table movie; /*to give inpath the file should be in hdfs..if file in linux use local inpath
    $create table genre(gid int,genre string) row format delimited fields terminated by '\t';
    $load data inpath '/movie_data/genre/' into table genre;
    $create table moviegenre(mid int,gid int) row format delimited fields terminated by '\t';
    $load data inpath '/movie_data/moviegenre/' into table moviegenre;
    $create table movierating(uid int,mid int,rating int) row format delimited fields terminated by '\t';
    $load data inpath '/movie_data/movierating/' into table movierating;
    1) how many movies were relieased in a year
        $select year,count(*) from movie group by year;
    2)year with maximum movies
        $ select year,count(*) as nom from movie group by year order by nom desc limit 3;

    3)which genre has maximum movies
        $select g.genre,count(*) as nom from genre g join moviegenre mg on (g.gid=mg.gid) join movie m on (m.mid=mg.mid) group by g.genre;      /*total number in each genre
        $select g.genre,count(*) as nom from genre g join moviegenre mg on (g.gid=mg.gid) join movie m on (m.mid=mg.mid) group by g.genre order by nom limit 1;
    3)which movie is of which genre?
        $select m.mname,g.genre from movie m join moviegenre mg on (m.mid=mg.mid) join genre g on (g.gid=mg.gid);

    4)in 2000,how many movies were under genre comedy?

CHECK           select year,count(*) from movie m join moviegenre mg on (m.mid=mg.mid) join genre g on (g.gid =mg.mid) where g.genre='Comedy' group by year having year ='2000';
#we can see all tables in mysql metadata
    use metastore
    select * from TBLS;
#EXTERNAL tables
    > create external table movieentertain(mid int,mname string) row format delimited fields terminated by ',' location '/entertain';
    /*there is a csv file in /entertain we are transfering to hive as external table name movieentertain

#HIVE PARTITIONS
    create table moviepartition (mid int,mname string,year string) partitioned by (mgenre string) row format delimited fields terminated by '\t';
    load data local inpath '/home/training/mov' into table moviepartition partition(mgenre='bus');

#hive dynamic partition

#bucketing

create view moviecomp as select m.mid,m.mname,m.year,g.gid,g.genre from movie m join moviegenre mg on (m.mid=mg.mid) join genre g on (g.gid=mg.gid);
describe moviecomp;
create table moviebucket (mid int,mname string,year string,gid int,gname string) clustered by (year) into 5 buckets;
insert into table moviebucket select * from moviecomp;




